appPrefix: tensorflow-distributed

MultiWorkerMirroredStrategy:
  replicas: 3
  nproc_per_node: 1
  resources:
    requests:
      nvidia.com/gpu: 1
    limits:
      nvidia.com/gpu: 1
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: nvidia.com/gpu.count
                operator: In
                values:
                  - "1"
                  - "2"
                  - "4"
                  - "8"
                  - "16"
  args:
    - python3
    - main.py
    - --epochs=10
    - --steps=70
    - --batch-size=64
    - --learning-rate=0.1
    - --collective-communication=auto

imageCredentials:
  registry: nvcr.io
  username: $oauthtoken
  password: "api-key"
  email: "user@nvidia.com"

baseImage:
  repository: registry.local:31500/distributed/tensorflow
  pullPolicy: Always
  tag: "v0.1.0"
  imagePullSecrets:
    - ngc-secret
